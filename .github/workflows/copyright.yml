name: Copyright update
on:
    push:
#  schedule:
#    - cron: '00 03 1 1 * *'
#  To test:
#    - cron: '00 13 22 2 * *'
jobs:
  Update-Copyright-Date:
    runs-on: ubuntu-latest
    strategy:
      fail-fast: true
    steps:
    - uses: actions/checkout@v2
      with:
        token: ${{ secrets.GITHUB_TOKEN }}
        fetch-depth: 0
    - name: update date
      run: |
        last_year=$(date --date='1 year ago' +%Y)
        this_year=$(date +"%Y")
        find . -type f -exec sed -i'' -e 's/2017-${last_year}/2017-${this_year}/g' {} +
    - name: pull-request
        uses: repo-sync/pull-request@v2
        with:
          destination_branch: "master"
          github_token: ${{ secrets.GITHUB_TOKEN }}
